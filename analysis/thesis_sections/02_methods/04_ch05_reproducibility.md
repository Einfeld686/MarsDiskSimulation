## 5. 出力と検証

<!--
実装(.py): marsdisk/run_zero_d.py, marsdisk/run_one_d.py, marsdisk/io/writer.py, marsdisk/io/streaming.py, marsdisk/io/diagnostics.py, scripts/validate_run.py
-->

本節では，本研究の計算結果を「後から読み直しても同じ結論に到達できる」形で残すために，保存すべき出力量と，本文で採用する計算が満たすべき合格基準（検証）をまとめる．ここでいう再現性は，図表作成や追加解析が，計算実行時の内部状態に依存せず，保存された出力（と入力条件の記録）から一意に再構成できることを指す．

### 5.1 出力仕様と検証基準

本研究で直接追跡する状態量は，各粒径ビン $k$ に離散化した粒子数面密度 $N_k(t)$ と，表層面密度 $\Sigma_{\rm surf}(t)$ である．したがって，再解析のために必要な情報は，(a) これらの時間発展を決める入力条件（初期条件・物理パラメータ・外部テーブルの参照情報を含む）と，(b) 主要診断量の時系列，(c) PSD（粒径分布）の履歴，(d) 計算終了時点の集計，および (e) 数値的健全性を確認する検証ログである．これらを実行ごとに保存しておけば，本文の図表は保存された出力のみを入力として再構成できる（保存情報の要点は付録 Aにまとめる）．

保存する診断量の中心は，各ステップの時刻 $t$ と時間刻み $\Delta t$ に加え，放射圧流出を特徴づける $\tau_{\rm los},\,s_{\rm blow},\,s_{\min}$，および表層の状態を表す $\Sigma_{\rm surf},\,\dot{M}_{\rm out}$ などである．PSD は $N_k(t)$ を独立に記録し，任意時刻の分布形状とその変化を追跡できるようにする．1D 計算では半径セルごとに同様の時系列を保存するため，円盤全体の量は半径積分（離散和）として再構成できる．出力は機械可読な形式（例：JSON/Parquet/CSV）で保存し，入力条件の記録，主要スカラー時系列，PSD 履歴，終端要約，質量検査ログが最小セットとして残るよう構成している．

円盤からの累積損失 $M_{\rm loss}$ は，表層流出率 $\dot{M}_{\rm out}$ と追加シンク（昇華など）による損失率 $\dot{M}_{\rm sinks}$ を区分一定近似で積算し，式\ref{eq:mass_loss_update}で更新する\citep{Wyatt2008}．本論文では質量を火星質量 $M_{\rm Mars}$ で規格化して示すため，$\dot{M}_{\rm out}$ と $M_{\rm loss}$ も同様に規格化した量として扱う．

\begin{equation}
\label{eq:mass_loss_update}
M_{\rm loss}^{n+1}=M_{\rm loss}^{n}+\Delta t\left(\dot{M}_{\rm out}^{n}+\dot{M}_{\rm sinks}^{n}\right)
\end{equation}

計算の検証は，質量保存，時間刻み収束，および粒径ビン収束（PSD 解像度）の 3 項目で行う．合格基準は表\ref{tab:validation_criteria}に示し，本文で示す結果はすべて基準を満たした計算に限定する．質量保存は，式\ref{eq:mass_budget_definition}で定義する相対質量誤差 $|\epsilon_{\rm mass}(t)|$ の最大値が $0.5\%$ 以下であることを要求する．

一方，数値離散化に起因する系統誤差は，より細かい離散化（ref）に対する相対差で評価する．ここでは任意の指標 $X$ について相対差を

\begin{equation}
\label{eq:relative_difference_definition}
\Delta_{\rm rel}(X)\equiv \frac{|X({\rm coarse})-X({\rm ref})|}{|X({\rm ref})|}
\end{equation}

と定義する．時間刻み収束では ${\rm ref}$ を $\Delta t/2$ とした計算とし，$\Delta_{\rm rel}(M_{\rm loss})\le 1\%$ を合格条件とする．$M_{\rm loss}$ は式\ref{eq:mass_loss_update}で時間積分される累積量であるため，離散化誤差が蓄積して現れやすく，収束判定の代表指標として適している．

粒径ビン収束（PSD 解像度）では，${\rm ref}$ を粒径ビン幅を 1/2 にしてビン数を 2 倍とした PSD の計算とし，時間刻み収束と同じく $\Delta_{\rm rel}(M_{\rm loss})\le 1\%$ を要求する．この比較により，粒径離散化の取り方が，結論に影響し得る大きさの系統誤差を導入していないことを確認する．

\begin{table}[t]
\centering
\small
\setlength{\tabcolsep}{3pt}
\caption{検証項目と合格基準}
\label{tab:validation_criteria}
\begin{tabular}{p{0.27\textwidth} p{0.69\textwidth}}
\hline
検証項目 & 合格基準（許容誤差） \\
\hline
質量保存 & 相対質量誤差 $|\epsilon_{\rm mass}(t)|$ の最大値が $0.5\%$ 以下 \\
時間刻み収束 & $\Delta t$ と $\Delta t/2$ の $M_{\rm loss}$ の相対差が $1\%$ 以下 \\
粒径ビン収束（PSD 解像度） & 基準ビンとビン数を 2 倍にした計算の $M_{\rm loss}$ の相対差が $1\%$ 以下 \\
\hline
\end{tabular}
\end{table}

以上の出力仕様と検証基準により，入力条件から出力への対応が追跡可能であること，ならびに数値的に健全であること（質量保存と，時間刻み・粒径ビン（PSD 解像度）に関する収束性）を担保したうえで，本論文の結果と議論を構成する．

### 5.2 仮定と限界

本手法は，遷移期における放射圧起因の表層質量流出を定量化することに焦点を当てた簡略モデルであり，円盤の全過程を余さず解くことを目的としていない．そのため，いくつかの近似を明示的に導入している．

まず，半径方向の輸送過程（粘性拡散や PR ドラッグなど）は支配方程式としては解かず，各半径セルにおける局所進化を独立に評価する．この設計は，放射圧による表層損失と衝突カスケードの結合に計算資源を集中させる意図に沿う一方，セル間輸送が卓越する状況では本モデルの表現力が不足し得る．したがって円盤全体量は，セルごとの結果を半径方向に積分して再構成し，その意味づけも「局所進化の集約」として行う必要がある．

次に，衝突速度の評価では，相対速度を与える離心率 $e$ と傾斜角 $i$ を代表値として固定し，低離心率・低傾斜の近似式を速度スケールとして用いる．この近似は，厳密な励起・散乱過程を扱わない代わりに，衝突頻度と破壊効率の主要な依存性を一つのスケールに押し込み，衝突カスケードの時間発展を記述可能にするものである．一方で，$e,i$ の時間変化やサイズ依存が重要な場合には，衝突速度の推定に系統誤差が入り得るため，その影響は感度掃引の範囲として別途評価する．

また，自己遮蔽は遮蔽係数 $\Phi$ を有効不透明度 $\kappa_{\rm eff}$ に反映させ，初期規格化と停止判定（光学的に厚い領域をモデル適用外として除外する判定）に用いる．しかし，遮蔽によって放射圧パラメータ $\beta$ 自体が連続的に減衰するような詳細な放射輸送は扱わない．したがって本手法は，遮蔽が強くなり過ぎて「表層」という概念が曖昧になる領域では，そもそも適用対象外として計算を停止する設計になっている．

さらに，昇華は粒径縮小 $ds/dt$ を一次シンクへ写像し，粒径空間の移流（ビン間移送）としては追跡しない．この近似は，昇華が分布形状を滑らかに輸送する効果よりも，「その粒径帯の粒子が消失する」効果を優先して取り込むものである．昇華が支配的な領域では PSD の形状変化に差が出る可能性があるため，昇華が寄与する計算では，出力された診断量と併せて解釈の範囲を明確にする．

以上の近似の影響は，5.1節の検証基準（質量保存・時間刻み収束・粒径ビン（PSD 解像度）収束）と，パラメータの感度掃引により定量的に評価する．本論文の結論は，これらの検証と感度の範囲内で支持される主張に限定して述べる．
