# 衝突エネルギー保存（熱化）・速度減衰：要件整理メモ  
（前提：壊滅的破砕 = Krivov et al. 2006、侵食 = Thébault et al. 2003）

作成日: 2025-12-17  
対象: MarsDiskSimulation（0D Smoluchowski／粒径分布の時間発展）

---

## 1. このメモの目的（「熱はどれだけ出るか」を定義できるようにする）
このメモは、現状のシミュレーションで未実装と整理されている **衝突による速度減衰・エネルギー散逸**を、採用予定の衝突結果モデル

- 壊滅的破砕（catastrophic fragmentation）：Krivov et al. (2006) の破片生成関数  
- 侵食（cratering）：Thébault et al. (2003) のクレーター質量則  

に合わせて、**エネルギー保存（とくに「運動エネルギーがどれだけ内部エネルギーへ変わるか」）の要件として整理**します。

ここでいう「熱」は、厳密な温度上昇を計算する意味ではありません。衝突で失われた運動エネルギーは、熱だけでなく音・局所変形・新表面生成などへも変換されます。したがって本メモでは、

- **散逸エネルギー**：衝突後に運動エネルギーとして残らなかった分  
- **熱化（の代理）**：散逸エネルギーを温度計算へ進めない場合の、内部エネルギー化量の上限  

という位置づけで扱います。

---

## 2. 記号と、衝突で使うエネルギーの定義（コード ↔ 文献）
エネルギー保存を入れるときに最初に固定すべきことは、**「衝突前の基準エネルギー」**です。ここでは、2体の相対運動が持つ運動エネルギーを基準にします。

### 2.1 相対速度（コード側の近似）
プロジェクト内では、低離心率・低傾斜の近似として  
\[
v_{ij} = v_{K}\,\sqrt{1.25\,e^{2} + i^{2}}
\]
が定義されています（係数 1.25 は実装選択）。

課題整理文書では導入用の簡略形として  
\[
v_{\mathrm{rel}} \approx v_K\sqrt{e^2+i^2}
\]
も併記されています（以後の説明では、実装式の \(v_{ij}\) を使うのが安全です）。

### 2.2 重心系の比衝突エネルギー \(Q_R\)（コード側）
コード側には「重心系の比衝突エネルギー（単位質量あたり）」が定義されています。  

\[
\begin{aligned}
M_{\mathrm{tot}} &= m_1 + m_2, \\
\mu &= \frac{m_1 m_2}{M_{\mathrm{tot}}},\\
Q_R &= \frac{1}{2}\frac{\mu v^{2}}{M_{\mathrm{tot}}}.
\end{aligned}
\]

### 2.3 1回の衝突での相対運動エネルギー \(E_{\mathrm{rel}}\)
文献（Thébault et al. 2003）では、衝突系の相対運動エネルギーを  
\[
E_{\mathrm{rel}}=\frac{M_i M_j}{2(M_i+M_j)}\,\Delta v^2
\]
と書いています。

コードの \(Q_R\) と同じ量を「総量」で書き直すと、
\[
E_{\mathrm{rel}}
= Q_R\,M_{\mathrm{tot}}
= \frac12\,\mu v^2
\]
です（代数変形）。  
**以後の熱化・散逸の定義はこの \(E_{\mathrm{rel}}\) を基準にします。**

---

## 3. 採用予定モデルが持つ「エネルギー要素」を分解する
ここでは「熱はどれだけ出るか」を決める上で、各モデルがどこまで情報を持っているかを明確にします。

### 3.1 Thébault et al. (2003)：侵食（cratering）側は散逸率を定義できる
Thébault et al. (2003) はまず、衝突が

- **壊滅的破砕**（最大残骸が 0.5 未満）  
- **侵食（クレーター化）**（最大残骸が 0.5 より大きい）  

のどちらかであると述べ、その判定に「最大残骸の質量比」\(F_{\mathrm{lf}}\) を使います。

頭突き衝突（head-on）に対して、経験式として

\[
F_{\mathrm{lf}}^{(0)}(i,j) = 0.5\left(\frac{Q^\* M_i}{E_{\mathrm{rel}}}\right)^{1.24}
\]

が与えられ（式(3)）、これを衝突角度平均した量として

\[
F_{\mathrm{lf}}(i,j) = 3\left(F_{\mathrm{lf}}^{(0)}(i,j)\right)^{2/3} - 2F_{\mathrm{lf}}^{(0)}(i,j)
\]

が与えられます（式(4)）。

侵食（\(F_{\mathrm{lf}}>0.5\)）のとき、クレーター化した総質量 \(M_{\mathrm{cr}}\) を

\[
M_{\mathrm{cr}}=\alpha E_{\mathrm{rel}}
\quad \text{for } E_{\mathrm{rel}} \le \frac{M_i}{100\alpha}
\]

\[
M_{\mathrm{cr}}=\text{(式(10) の関数形)}
\quad \text{for } E_{\mathrm{rel}} > \frac{M_i}{100\alpha}
\]

と置きます（式(9)(10)）。  
ここまでは「質量」だけの話ですが、熱化に直結するのは次です。

Thébault et al. (2003) は破片の再集積（fragment reaccumulation）の節で、破片の代表速度を

\[
v_{\mathrm{fr}}=\left(\frac{2 f_{\mathrm{ke}} E_{\mathrm{rel}}(i,j)}{M_i}\right)^{1/2}
\]

と置き、ここで \(f_{\mathrm{ke}}\) を  
**「衝突後に散逸されずに残る運動エネルギーの割合」**  
として定義し、典型値として \(f_{\mathrm{ke}}=0.1\) を採用しています（式(11) の直後の説明）。

> したがって侵食側モデルには、すでに「散逸率（1 − f_ke）」が含まれています。  

### 3.2 Krivov et al. (2006)：壊滅的破砕は「しきい値」と「質量分布」は与えるが、熱化率は別途必要
Krivov et al. (2006) は、破片質量の上限 \(m_x\) を

\[
m_x = \frac{m_t}{2}
\left[
\frac{2m_t}{m_p}\,
\frac{Q_D^\*(m_t)}{v_{\mathrm{imp}}^{2}}
\right]^{c}
\]

で与えています（式(21)、\(c\) は 1 に近い定数）。

また破壊しきい値 \(Q_D^\*\) は、サイズ（ここではターゲットのサイズ \(s_t\)）の2つの冪の和として

\[
Q_D^\* = A_s\,s_t^{\,b_s} + A_g\,s_t^{\,b_g}
\]

と置かれます（式(22)）。

両天体を壊すのに必要なエネルギー
\[
m_t Q_D^\*(m_t)+m_p Q_D^\*(m_p)
\]
を導入し、非弾性衝突の運動エネルギーが臨界を超えると破砕（fragmenting）とみなす、と説明しています。これを簡約して、破砕となる最小投射体質量を

\[
m_{\mathrm{cr}} \approx 2m_t\,\frac{Q_D^\*(m_t)}{v_{\mathrm{imp}}^{2}}
\]

と書いています（式(23)）。

破片生成関数のうち、質量分布 \(g\) は

\[
g(m) = (2-\eta)\,(m_p+m_t)\,
\left(\frac{m_x}{m}\right)^{\eta}\,
\frac{1}{m_x^{2}}
\qquad (m_{\min}\le m \le m_x)
\]

と与えられます（式(25)）。  
（この形から \(g(m)\propto m^{-\eta}\) の冪が読み取れます。）

ここまでで「破砕の判定」と「質量分布」は決まりますが、**「衝突で失われる運動エネルギーがどれだけ散逸して内部エネルギーへ行くか」**は、独立の係数としては登場しません。

> したがって、壊滅的破砕（Krivov 2006）を採る場合、熱化量をログしたいなら **\(f_{\mathrm{ke}}\) 相当の要素を別途足す必要**があります。

---

## 4. 追加すべき「エネルギー保存（熱化）」要件（提案）
ここからは提案です。目的は「熱化量を定義してログに残せる」こと、そして「速度減衰（e/i）と矛盾しない」ことです。

### 4.1 1衝突イベントでの最小エネルギー収支（必須）
衝突 1 回あたりの基準エネルギーを  
\[
E_{\mathrm{rel}}=\frac12\,\mu v^2
\]
とします（§2.3）。

次に、衝突後に「運動エネルギーとして残る分」と「散逸する分」を分けます。Thébault の定義に合わせて

\[
E_{\mathrm{kin,after}} = f_{\mathrm{ke}}\,E_{\mathrm{rel}},
\qquad
E_{\mathrm{diss}} = (1-f_{\mathrm{ke}})\,E_{\mathrm{rel}}
\]

と置けば、**熱化（内部エネルギー化）の代理量**として \(E_{\mathrm{diss}}\) を定義できます。

- 侵食側（Thébault）では、文献定義どおり \(f_{\mathrm{ke}}\) を使える  
- 破砕側（Krivov）では、同種の \(f_{\mathrm{ke}}\)（または別名の係数）を導入しないと \(E_{\mathrm{diss}}\) を定義できない  

このときの実装要件は単純で、

- \(0\le f_{\mathrm{ke}}\le 1\) を必ず満たす  
- 侵食・破砕で同じ \(E_{\mathrm{rel}}\) を基準に使う（定義を分裂させない）  

です。

### 4.2 速度減衰モデル（反発係数）との整合：\(f_{\mathrm{ke}}\) を結びつける（推奨）
衝突前後で、接触線方向の相対速度がどれだけ残るかを表す量として  
「反発係数（coefficient of restitution）」が使われます（課題整理文書でも速度減衰の候補として言及）。

反発係数を \(e\) とすると、重心系での運動エネルギー損失は
\[
\Delta T = -(1-e^2)\,\frac12\,\mu(\Delta u)^2
\]
と書け、これは「エネルギーが \(e^2\) 倍残る」と同値です。

したがって、**実装上の整合条件**として

\[
f_{\mathrm{ke}} \approx e_{\mathrm{eff}}^2
\]

という対応を置くことができます。  
ただし \(e\) は接触線方向の量で、\(f_{\mathrm{ke}}\) は破砕も含んだ全体量なので、ここは「近似としての対応」です（厳密な等価とは書きません）。

### 4.3 e/i を更新して「速度減衰」を実際に反映する（課題整理文書の案）
熱化ログだけ入れても、e/i が固定のままだと「衝突で失う運動エネルギー」が速度分散に反映されません。  
課題整理文書では、衝突時間 \(t_{\mathrm{coll}}\) と反発係数 \(\varepsilon\) を用いて

\[
t_{\mathrm{damp}} = \frac{t_{\mathrm{coll}}}{\varepsilon^{2}}
\]

\[
e_{n+1} = e_n + \left(\frac{c_{\mathrm{eq}}}{v_K}-e_n\right)\left(1-e^{-\Delta t/t_{\mathrm{damp}}}\right)
\]

（同様に \(i\) も更新する）という更新式が示されています。  
この枠組みを採る場合、§4.2 の対応 \(f_{\mathrm{ke}}\approx \varepsilon^2\) を置くと、熱化ログと e/i 減衰が同じ向きを向きやすくなります。

### 4.4 「新しい表面を作るのにもエネルギーが要る」制約（任意だが効果が大きい）
破砕で非常に小さい破片を無制限に作ると、表面積が発散し、物理的に無理が出ます。  
Krijt & Kama (2014) はこの点を、**表面エネルギー**を使ってエネルギー保存から抑える方法を提示しています。

彼らはサイズ分布 \(n(s)=Cs^{-\alpha}\) を仮定し、運動エネルギーのうち \(\eta\) だけが新表面生成に使えるとして、最小サイズを

\[
s_{\min} =
\left(\frac{6\gamma(\alpha-3)}{\eta \rho v_{\mathrm{rel}}^{2}}\right)^{2}\,
s_{\max}^{\alpha-5}
\qquad (\alpha\ne 5)
\]

（\(\alpha=5\) の場合は指数関数形）と書いています。  
この要素を入れると、破砕側（Krivov）の「下限カット」が数値都合から離れ、**エネルギー保存で決まる**ようになります。

実装としては、最初は **オプション機能**にして、

- Krijt & Kama の \(s_{\min}\) を「破砕で出しうる最小サイズ」の候補として計算する  
- 既存の \(s_{\min}\)（例：ブローアウト径や昇華床）と比較して、採用する下限を決める  

という形が安全です（既存設定を壊さずに感度試験ができます）。

---

## 5. 0D Smoluchowski へ落とすときのログ定義（最小形）
Smoluchowski 更新は
\[
\dot{N}_k = \tfrac{1}{2}\sum_{i,j} K_{ij}\,N_i N_j\,Y_{kij} - N_k\sum_j K_{kj}N_j + f_k
\]
と置かれています（コードの基礎式）。

衝突に伴う散逸エネルギー率（面積あたり・時間あたり）の最小定義は、対称性を考えて

\[
\dot{E}_{\mathrm{diss}}
=
\frac12\sum_{i,j}
\left(K_{ij} N_i N_j\right)\,
\left(1-f_{\mathrm{ke},ij}\right)\,
E_{\mathrm{rel},ij}
\]

と書けます。  
実装の都合で \(K_{ij} N_i N_j\) ではなく、すでに計算済みの衝突フラックス行列（例：\(C_{ij}\)）を使うなら、単位が合うように等価変形して同じ和を作ります。

### 5.1 `checks/energy_budget.csv` に最低限入れる列（提案）
実装の粒度は自由ですが、「後で比較できる」ことを優先すると、列は次の 4 つから始めるのが扱いやすいです。

1. 時刻（またはステップ番号）  
2. 衝突による散逸エネルギー（\(\Delta t\) で積分した量）  
3. ブローアウト等で系外へ出る粒子が持って出る運動エネルギー（扱うなら）  
4. 参考として、衝突総相対エネルギー（\(\sum E_{\mathrm{rel}}\)）と \(f_{\mathrm{ke}}\) の採用値（平均など）

ここで 2. が本メモの中心です。3. はモデルが「粒子を除去」する処理を持つ場合、全体のエネルギー収支を見たいときに役立ちます。


---

## 6. 質問への明記（どこまでモデル内に含まれるか）
- **侵食側（Thébault et al. 2003）**には、衝突後に「散逸されずに残る運動エネルギー割合」\(f_{\mathrm{ke}}\) が明示されている。したがって散逸量 \((1-f_{\mathrm{ke}})E_{\mathrm{rel}}\) を直接定義できる。  
- **壊滅的破砕側（Krivov et al. 2006）**は、破砕判定のしきい値（\(Q_D^\*\)）と破片の質量分布（冪指数）を与えるが、熱化割合や散逸量を直接与える係数は（少なくとも該当節では）明示されない。よって「どれだけ熱が出るか」をログしたいなら、\(f_{\mathrm{ke}}\) 相当の要素を別途導入する必要がある。  
- 破砕の下限サイズをエネルギー保存から決めたい場合は、Krijt & Kama (2014) の表面エネルギー制約が候補になる。  

---

## 7. 参考文献（今回参照した箇所）
- Thébault, P., Augereau, J.-C., Beust, H. (2003), *The inner β Pictoris disc*, A&A 402, 763.（arXiv:astro-ph/0307167）  
  - \(F_{\mathrm{lf}}\) と \(E_{\mathrm{rel}}\)（式(3)(4)）、クレーター質量則（式(9)(10)）、\(f_{\mathrm{ke}}\) の定義（式(11) 直後）  
- Krivov, A. V., Löhne, T., Sremčević, M. (2006), A&A 455, 509.  
  - \(m_x\)（式(21)）、\(Q_D^\*\)（式(22)）、破砕判定（式(23) 周辺）、破片質量分布 \(g(m)\)（式(25)）  
- Krijt, S., Kama, M. (2014), *The smallest fragments in debris discs*, A&A 566, L2.（arXiv:1404.6167）  
  - 表面エネルギー制約からの \(s_{\min}\)（式(4)）  
- 反発係数とエネルギー損失式（重心系で \((1-e^2)\) が損失率になる形）  
  - 教科書的整理として（例：Wikipedia、講義ノート）
