# Q_D*（玄武岩モデル）が SiO2 円盤に対して過大な件の整理

> **作成日**: 2025-12-16  
> **状況**: 現象整理と対応案

---

## 背景：本プロジェクトについて

本リポジトリ（MarsDiskSimulation / `marsshearingsheet`）は、**火星ロッシュ限界内の高密度ダストディスク**を対象に、放射圧によるブローアウトと衝突破砕カスケードをシミュレーションして質量損失・流出率を定量化するものです。詳細は以下を参照してください：

- **全体仕様**: [analysis/overview.md](../../analysis/overview.md)
- **物理モデル式**: [analysis/equations.md](../../analysis/equations.md)
- **実行レシピ**: [analysis/run-recipes.md](../../analysis/run-recipes.md)

### Q_D*（破壊強度閾値）とは

$Q_D^*$ は**天体を "catastrophically disrupt" する（半分以上の質量を分散させる）のに必要な比衝突エネルギー**を表すパラメータです。本シミュレーションでは衝突カスケードにおける破片分配を計算する際に使用します。

$$
Q_D^*(s, \rho, v) = Q_s \left(\frac{s}{1\,\mathrm{cm}}\right)^{-a_s} + B \rho \left(\frac{s}{1\,\mathrm{cm}}\right)^{b_g}
$$

- 第1項：材料強度レジーム（小粒子）
- 第2項：重力結合レジーム（大粒子）
- 参考式：(E.026) in [analysis/equations.md](../../analysis/equations.md)

### 用語定義

| 用語 | 意味 | 参考式・参照 |
|------|------|--------------|
| $Q_D^*$ | 破壊強度閾値（catastrophic disruption threshold） | (E.026) |
| $Q_s$, $a_s$ | 材料強度レジームの係数・冪指数 | Benz & Asphaug (1999) |
| $B$, $b_g$ | 重力結合レジームの係数・冪指数 | Leinhardt & Stewart (2012) |
| `prod_subblow_area_rate` | ブローアウト未満への破砕供給率 $\dot{\Sigma}^{(<a_{\rm blow})}_{\rm prod}$ | (E.027), (E.035) |
| `M_out_dot` | 表層からのブローアウト流出率 $\dot{M}_{\rm out}$ | (E.009) |

### 主要文献

- **Benz & Asphaug (1999)**: *Icarus* 142, 5–20. 玄武岩・氷の SPH 破壊シミュレーション、$Q_D^*$ のサイズ依存。
- **Leinhardt & Stewart (2012)**: *ApJ* 745, 79. 重力支配レジームへの拡張と衝突速度依存の補間。

### 本ドキュメントの位置付け

`docs/plan/` 内のドキュメントは開発プラン・イシュー整理を管理します。本メモは **Q_D* パラメータが SiO2 溶融円盤に対して不適切である問題**の調査と対応方針をまとめたものです。

---

## 何が起きているか
- `qstar` の既定値は Benz & Asphaug (1999) の玄武岩質パラメータを、Leinhardt & Stewart (2012) の補間で 3–5 km/s に当てはめたもの。[marsdisk/physics/qstar.py:1–120]
- `configs/base.yml` / `configs/sweep_temp_supply/temp_supply_T4000_eps1.yml` で Qs=3.5e7/7.0e7, a_s=0.38, B=0.3/0.5, b_g=1.36 をそのまま採用（玄武岩想定）。
- SiO2 溶融・ガラス円盤ではこれら係数が過大で、破砕が起きにくくサブブロー粒子への質量移送が抑制される。現行スイープでは最小ビンに質量が落ちず、`M_out_dot` が立たない一因になっている。
- 衝突速度はスイープで 3–5 km/s 固定補間を想定しているが、実際の速度分布（e=0.5 前提）とマテリアルがミスマッチ。

## 影響
- サブブロー生成が不足し、ブローアウトフラックスがゼロ近傍のケースが多い（今回の `T6000_mu1p0_phi20` など）。
- Q_D* が高い前提のままでは、SiO2 円盤に対する破砕時間スケールを過大評価し、質量損失を過小見積もるリスクがある。

## 対応案
- **短期の感度試験**: Qs と B を係数スケールで下げたバリエーション（例: 0.1×, 0.01×）を用意し、最小ビン質量・`M_out_dot` の応答を確認。
- **SiO2 向けパラメータ収集**: ガラス/溶融 SiO2 の破壊強度データ（実験・数値）を当たり、Q_D* のサイズ・速度依存を再設定する。Bruning などの SiO2 ガラス破砕文献を候補にする。
- **実装フック**: 材料プリセット（basalt / SiO2_glass など）で `_COEFFS` を切り替えるか、YAML から係数を与えるモードを追加し、玄武岩デフォルトからの上書きを簡便化する。
- **速度レンジの見直し**: 衝突速度分布が 3–5 km/s を外れる場合の外挿を避けるため、v_ref を設定値や実測に合わせて広げるか、外挿の警告を出す。

## 次のステップ（提案）
- [ ] Qs/B をスケールダウンした感度スイープ（1.0, 0.1, 0.01）を scripts に追加し、`prod_subblow_area_rate` と `M_out_dot` の変化を比較。
- [ ] SiO2 物性データの出典を洗い出し、`qstar` の係数セットを追加（暫定でもよい）。
- [ ] YAML から Q_D* 係数を注入するオプションを用意し、material プロファイルを明示できるようにする。
- [ ] 感度結果を `analysis/overview.md` か run_catalog に反映し、玄武岩モデルの限界を注記。***
